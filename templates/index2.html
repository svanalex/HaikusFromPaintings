<!DOCTYPE html>
<html>
<head>
    <title>Emotion Engine & Haiku Generator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }
        select, input[type="file"], button {
            margin: 10px 0;
        }
        pre {
            background-color: #f4f4f4;
            padding: 10px;
            white-space: pre-wrap;
        }
        hr {
            margin: 40px 0 20px;
        }
    </style>
</head>
<body>
    <h1>Select Personality Profile</h1>

    <form method="POST" enctype="multipart/form-data">
        <!-- Personality dropdown -->
        <label for="profile">Choose a personality:</label><br>
        <select name="profile">
            {% for profile in profiles %}
                <option value="{{ profile }}" {% if selected == profile %}selected{% endif %}>{{ profile.title() }}</option>
            {% endfor %}
        </select>

        <br><br>

        <!-- Prompt template dropdown -->
        <label for="prompt_template">Choose Prompt Template:</label><br>
        <select name="prompt_template">
            <option value="instructional">Instructional</option>
            <option value="contextual">Contextual</option>
            <option value="role_based">Role-Based</option>
            <option value="example_driven">Example-Driven</option>
            <option value="iterative">Iterative</option>
        </select>

        <br><br>

        <!-- Image upload -->
        <label for="image">Upload an image (for Haiku generation):</label><br>
        <input type="file" name="image">

        <br><br>

        <!-- Action buttons -->
        <button type="submit" name="action" value="Generate Mood Only">Run Emotion Engine</button>
        <button type="submit" name="action" value="Generate Haiku">Run Haiku Orchestrator</button>
    </form>

    {% if mood %}
    <hr>
    <h2>Emotion Engine Output</h2>
    <p><strong>Final Emotion:</strong> {{ mood.final_emotion }}</p>
    <p><strong>Personality:</strong> {{ mood.personality_profile }}</p>

    <h3>Explanation</h3>
    <pre>{{ mood.narrative_explanation }}</pre>

    <h3>System Description</h3>
    <pre>{{ mood.system_explanation }}</pre>
    {% endif %}

    {% if haiku_data %}
    <hr>
    <h2>Generated Haiku</h2>
    <pre>{{ haiku_data.haiku }}</pre>

    <h3>Prompt Used</h3>
    <pre>{{ haiku_data.prompt }}</pre>

    <h3>Extracted Image Features</h3>
    <pre>{{ haiku_data.image_features }}</pre>
    {% endif %}
</body>
</html>
